<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Grace Cooper">
<meta name="dcterms.date" content="2024-08-30">
<meta name="description" content="An introduction to gridded data sources used to measure human presence across the globe">

<title>Measuring Population Density – IPUMS DHS Spatial Analysis and Health Research Hub</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../images/favicon/favicon-32x32.ico" rel="icon">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-03fd5f99cfc2f8297f3c5ef65ead31dc.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-7590f946cc175b093b1053850525e467.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/quarto-contrib/fontawesome6-0.1.0/all.css" rel="stylesheet">
<link href="../../site_libs/quarto-contrib/fontawesome6-0.1.0/latex-fontsize.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-0WLH5S9VD5"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-0WLH5S9VD5', { 'anonymize_ip': true});
</script>


<meta property="og:title" content="Measuring Population Density">
<meta property="og:description" content="An introduction to gridded data sources used to measure human presence across the globe">
<meta property="og:image" content="https://ipums.github.io/dhs-research-hub/posts/2024-08-30-pop-density/images/listing-img.png">
<meta property="og:site_name" content="IPUMS DHS Spatial Analysis and Health Research Hub">
<meta property="og:image:height" content="600">
<meta property="og:image:width" content="615">
<meta name="twitter:title" content="Measuring Population Density">
<meta name="twitter:description" content="An introduction to gridded data sources used to measure human presence across the globe">
<meta name="twitter:image" content="https://ipums.github.io/dhs-research-hub/posts/2024-08-30-pop-density/images/listing-img.png">
<meta name="twitter:image-height" content="600">
<meta name="twitter:image-width" content="615">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="https://www.idhsdata.org/idhs/" class="navbar-brand navbar-brand-logo">
    <img src="../../images/dhs_logo_white.png" alt="" class="navbar-logo">
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">Spatial Analysis and Health Research Hub</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">Posts</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-getting-started" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Getting Started</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-getting-started">    
        <li>
    <a class="dropdown-item" href="../../posts/2024-02-01-getting-started-with-r/index.html">
 <span class="dropdown-text">An Introduction to R</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../posts/2024-02-02-download-dhs-data/index.html">
 <span class="dropdown-text">Obtaining IPUMS DHS Data</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-community" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Community</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-community">    
        <li>
    <a class="dropdown-item" href="https://forum.ipums.org">
 <span class="dropdown-text">IPUMS Forum</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../CODE_OF_CONDUCT.html">
 <span class="dropdown-text">Code of Conduct</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../LICENSE.html">
 <span class="dropdown-text">License</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://github.com/ipums/dhs-research-hub"> 
<span class="menu-text"><i class="fa-brands fa-github" aria-label="github"></i></span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../index.xml"> 
<span class="menu-text"><i class="fa-solid fa-rss" aria-label="rss"></i></span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://twitter.com/ipumsGH"> 
<span class="menu-text"><i class="fa-brands fa-x-twitter" aria-label="x-twitter"></i></span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://forum.ipums.org"> 
<span class="menu-text"><i class="fa-solid fa-users" aria-label="users"></i></span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://www.ipums.org/"> 
<span class="menu-text"><i class="fa-solid fa-globe" aria-label="globe"></i></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default toc-left page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Measuring Population Density</h1>
                  <div>
        <div class="description">
          <p>An introduction to gridded data sources used to measure human presence across the globe</p>
        </div>
      </div>
                          <div class="quarto-categories">
                <div class="quarto-category">Population</div>
                <div class="quarto-category">Population density</div>
                <div class="quarto-category">Urbanization</div>
                <div class="quarto-category">Data sources</div>
                <div class="quarto-category">GRUMP</div>
                <div class="quarto-category">GHSL</div>
                <div class="quarto-category">LandScan</div>
                <div class="quarto-category">WorldPop</div>
                <div class="quarto-category">Research concepts</div>
              </div>
                  </div>
  </div>
    
  <div class="quarto-title-meta-author">
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-heading">Affiliation</div>
    
      <div class="quarto-title-meta-contents">
      <p class="author">Grace Cooper </p>
    </div>
    <div class="quarto-title-meta-contents">
          <p class="affiliation">
              Senior Data Analyst, IPUMS
            </p>
        </div>
    </div>

  <div class="quarto-title-meta">

        
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">August 30, 2024</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="1">
    <h2 id="toc-title">Contents</h2>
   
  <ul>
  <li><a href="#background" id="toc-background" class="nav-link active" data-scroll-target="#background">Background</a></li>
  <li><a href="#common-population-density-data-sources" id="toc-common-population-density-data-sources" class="nav-link" data-scroll-target="#common-population-density-data-sources">Common population density data sources</a>
  <ul class="collapse">
  <li><a href="#global-rural-urban-mapping-project-grump" id="toc-global-rural-urban-mapping-project-grump" class="nav-link" data-scroll-target="#global-rural-urban-mapping-project-grump">Global Rural-Urban Mapping Project (GRUMP)</a></li>
  <li><a href="#global-human-settlement-layer-ghsl" id="toc-global-human-settlement-layer-ghsl" class="nav-link" data-scroll-target="#global-human-settlement-layer-ghsl">Global Human Settlement Layer (GHSL)</a></li>
  <li><a href="#landscan" id="toc-landscan" class="nav-link" data-scroll-target="#landscan">LandScan</a></li>
  <li><a href="#worldpop" id="toc-worldpop" class="nav-link" data-scroll-target="#worldpop">WorldPop</a></li>
  </ul></li>
  <li><a href="#comparing-sources" id="toc-comparing-sources" class="nav-link" data-scroll-target="#comparing-sources">Comparing sources</a>
  <ul class="collapse">
  
  </ul></li>
  </ul>
</nav>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
    </div>
<!-- main -->
<main class="content quarto-banner-title-block page-columns page-full" id="quarto-document-content">





<p>Researchers interested in understanding population distribution in the Global South are faced with a dilemma: data identifying where communities are and how many people live in them often does not exist. National censuses commonly report populations in aggregates, at province, district, or county levels—spatial resolutions much too coarse for studies of weather extremes or health.</p>
<p>Datasets that <em>estimate</em> how and where many people live (<strong>population density layers</strong>) do exist, but differ in fundamental ways, and the choice of which dataset to use depends on the scale and scope of the research question. For instance, some datasets are better at identifying built-up areas, while others excel at measuring rural populations. Similarly, researchers who need to understand how many people live in peri-urban areas would not benefit from a dataset that uses a dichotomous urban/rural variable to define built-up areas.</p>
<p>Furthermore, researchers studying change in population over time should be aware of comparability issues since some data providers update their methods regularly, making their datasets less comparable from year to year. Still, gridded population data are often the most effective tool for researchers to understand large-scale population distribution and explore human-environment relationships. Given the nuance of these datasets, how can we effectively include population density in our analyses?</p>
<p>As a start, this post will introduce several of the most widely-used population datasets:</p>
<ul>
<li>Global Rural-Urban Mapping Project (GRUMP)</li>
<li>Global Human Settlement Layer (GHSL)</li>
<li>LandScan</li>
<li>WorldPop</li>
</ul>
<p>Below, discuss each source’s history, input data layers, and methods used in its development. This can serve as a starting point for researchers to explore each dataset in more depth to determine which may be most appropriate for their specific research area.</p>
<section id="background" class="level1 page-columns page-full">
<h1>Background</h1>
<p>As fields of study related to extreme weather, health, and population grew in the 1970s and 80s, researchers began to recognize that a deeper understanding of population distribution was needed. Censuses are costly and populations are dynamic; it became apparent that datasets estimating where people live needed to be combined with census data.</p>
<p>The need to fill the gap in population data availability led to the development of the first global gridded population dataset in the 1990s (see <a href="#fig-1" class="quarto-xref">Figure&nbsp;1</a>): the Gridded Population of the World (GPW).<span class="citation" data-cites="Tobler1995 Deichmann1996 CIESIN"><sup><a href="#ref-Tobler1995" role="doc-biblioref">1</a>–<a href="#ref-CIESIN" role="doc-biblioref">3</a></sup></span> By combining population counts from censuses at second-administrative levels (i.e.&nbsp;counties and districts) with spatially-explicit administrative boundary data, researchers created a raster dataset that depicts population counts at 5-minute grid resolution (roughly 10km at the equator) on a continuous surface of the earth.<span class="citation" data-cites="Balk2006"><sup><a href="#ref-Balk2006" role="doc-biblioref">4</a></sup></span> This data enabled researchers studying extreme weather (data that are commonly reported as a gridded surface) to incorporate population into their analyses without aggregating environmental data to subnational administrative units.</p>
<div class="page-columns page-full">
<div id="fig-1" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca" class="page-columns page-full">
<img src="images/image3.png" class="img-fluid figure-img column-page">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Data publication timeline
</figcaption>
</figure>
</div>
</div>
<p>Since then, advancements in the technology used to collect remote sensing data, such as topography and land cover, have improved identification of urban areas.<span class="citation" data-cites="Pesaresi2013"><sup><a href="#ref-Pesaresi2013" role="doc-biblioref">5</a></sup></span> Increased computing power, improved spatial accuracy, and use of additional datasets such as night-time light satellite imagery, land cover, and digital elevation models (called <strong>ancillary data</strong>) have enabled researchers to advance the methods used to redistribute census population counts to grid cells at high resolution and accuracy.<span class="citation" data-cites="Leyk2019"><sup><a href="#ref-Leyk2019" role="doc-biblioref">6</a></sup></span> As a result, several gridded population datasets have been developed using different methods and input data, leading to datasets with varying spatial and population accuracy depending on the context. Below, we’ll highlight some of the similarities and differences between the prominent gridded population datasets that have been developed and identify appropriate use-case scenarios.</p>
</section>
<section id="common-population-density-data-sources" class="level1 page-columns page-full">
<h1>Common population density data sources</h1>
<p>A comparison of the spatial resolution, temporal availability, data/methods used, and best use cases for each of the four datasets we’re highlighting in this post are summarized in <a href="#tbl-1" class="quarto-xref">Table&nbsp;1</a> below, while <a href="#fig-1" class="quarto-xref">Figure&nbsp;1</a> (above) outlines the dates of first publication for each dataset. Without a proper understanding of how these data products are developed and their ideal use-cases, the research community is more likely to choose the wrong dataset for their project.<span class="citation" data-cites="Leyk2018"><sup><a href="#ref-Leyk2018" role="doc-biblioref">7</a></sup></span> In the subsequent sections, we introduce each dataset in additional detail.</p>
<section id="global-rural-urban-mapping-project-grump" class="level2">
<h2 class="anchored" data-anchor-id="global-rural-urban-mapping-project-grump">Global Rural-Urban Mapping Project (GRUMP)</h2>
<p>GRUMP is a series of global gridded population counts and densities created by Columbia University’s Centre for International Earth Science Information Network (CIESIN) in 2004, available for years 1990, 1995, and 2000.<span class="citation" data-cites="GRUMP"><sup><a href="#ref-GRUMP" role="doc-biblioref">8</a></sup></span> Using lightly-modeled dasymetric methods based on GPW population and NOAA night-time lights, it indicates the locations of urban settlements and delineates the spatial extents of urban areas at 30 arc-second (roughly 1 kilometer at the equator) resolution.<span class="citation" data-cites="Leyk2019"><sup><a href="#ref-Leyk2019" role="doc-biblioref">6</a></sup></span> In fact, it was the first global gridded population dataset to define urban areas and was widely used for two reasons:</p>
<ul>
<li>its urban footprint is based on stable-city lights which is an inclusive measure of urban areas</li>
<li>the dichotomous definition of the urban footprint (urban or rural) is simple for researchers to use<span class="citation" data-cites="Macmanus2021"><sup><a href="#ref-Macmanus2021" role="doc-biblioref">9</a></sup></span></li>
</ul>
<p>GRUMP’s popularity waned upon the creation of higher-resolution datasets that became available for more recent years, including the Global Human Settlement Layer (GHSL) created by the European Commission Joint Research Centre (JRC) in 2010.</p>
</section>
<section id="global-human-settlement-layer-ghsl" class="level2">
<h2 class="anchored" data-anchor-id="global-human-settlement-layer-ghsl">Global Human Settlement Layer (GHSL)</h2>
<p>Available in 5-year intervals from 1975 to 2020, GHSL data products are provided at a spatial resolution of 3 arc-seconds (roughly 100 meters at the equator). GHSL utilizes Landsat imagery (prior to 2014) and Sentinel-2 composite imagery (2014-forward) in an image classification method called Symbolic Machine Learning (SML) to map urban land cover and classify population and land area into seven classes along an urban-rural continuum.<span class="citation" data-cites="Pesaresi2016 Macmanus2021"><sup><a href="#ref-Macmanus2021" role="doc-biblioref">9</a>,<a href="#ref-Pesaresi2016" role="doc-biblioref">10</a></sup></span></p>
<p>The GHSL population data product is made up of three datasets: GHS-POP (population size), GHS-BUILT (built-up areas), and GHS-SMOD (a Degree of Urbanization model grid that delineates settlement types using GHS-POP and GHS-BUILT).<span class="citation" data-cites="Florczyk2019"><sup><a href="#ref-Florczyk2019" role="doc-biblioref">11</a></sup></span></p>
<p>GHSL has been widely used to study the interactions between weather extremes, health, and populations. For example, Pinchoff and colleagues<span class="citation" data-cites="Pinchoff2020"><sup><a href="#ref-Pinchoff2020" role="doc-biblioref">12</a></sup></span> used GHS-BUILT to examine the impact of urbanicity on health in Tanzania. McGranahan and colleagues<span class="citation" data-cites="McGranahan2023"><sup><a href="#ref-McGranahan2023" role="doc-biblioref">13</a></sup></span> used GHS-SMOD to calculate urbanization rates in low-elevation coastal zones and estimate the effect of urbanization on weather extremes in deltaic regions. In another study, the authors examined spatial accessibility to healthcare in sub-Saharan Africa (SSA) using GHS-SMOD.<span class="citation" data-cites="Florio2023"><sup><a href="#ref-Florio2023" role="doc-biblioref">14</a></sup></span></p>
</section>
<section id="landscan" class="level2">
<h2 class="anchored" data-anchor-id="landscan">LandScan</h2>
<p>While it is a lower resolution data product, LandScan is another prominent global population distribution dataset that provides ambient (24-hour average) population distribution at 30 arc-seconds (roughly 1 kilometer at the equator) resolution, developed in 1998 by the Oak Ridge National Laboratory in Tennessee.<span class="citation" data-cites="Dobson2000 Rose2014"><sup><a href="#ref-Dobson2000" role="doc-biblioref">15</a>,<a href="#ref-Rose2014" role="doc-biblioref">16</a></sup></span></p>
<p>In contrast to GRUMP and GHSL—which provide data at 5-year intervals—LandScan is available annually from 2000 through 2022. LandScan utilizes night-time light satellite imagery along with spatial information about elevation (Digital Elevation Models), slope (Digital Terrain Models), land cover, and populated place vector data within a multivariable dasymetric model that uses machine learning to assign the likelihood of population occurrence to each cell.</p>
<p>LandScan differs from other datasets in that it provides <em>ambient</em> population distribution, depicting not only where people sleep but where they travel, work, and socialize over a 24-hour period. While this may be an important distinction for some researchers, it sets the dataset apart from others, making it less comparable. Researchers should also take caution when comparing multiple versions of LandScan data—regular updates to the input data and distribution algorithm can cause comparability issues between versions.</p>
</section>
<section id="worldpop" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="worldpop">WorldPop</h2>
<p>WorldPop is another global gridded population distribution dataset that provides annual estimates from 2000 through 2020; however, WorldPop is provided at a higher resolution of 3 arc-seconds (roughly 100 meters at the equator). Developed by the University of Southampton in 2013, WorldPop uses Sentinel-1 and Sentinel-2 imagery in combination with spatial information on impervious surfaces (SRTM) and slope (DEM) in a dasymetric model with machine learning to estimate population distribution.<span class="citation" data-cites="Thomson2022"><sup><a href="#ref-Thomson2022" role="doc-biblioref">17</a></sup></span></p>
<p>WorldPop was created by combining three continental-scale population datasets:</p>
<ul>
<li>AfriPop (developed in 2009)</li>
<li>AsiaPop (developed in 2012)</li>
<li>AmeriPop (developed in 2013)</li>
</ul>
<p>WorldPop’s population estimates are fractional (not integer), which can produce difficulties in interpretation since individual persons obviously cannot be divided up over an area. Its prediction model is good at estimating activity space with the caveat that it can overestimate population density in peri-urban areas while under-estimating population densities in urban centers.</p>
<div id="tbl-1" class="hover bordered column-page quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1: Comparison of Gridded Population Datasets
</figcaption>
<div aria-describedby="tbl-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="table-hover table-bordered caption-top table">
<colgroup>
<col style="width: 15%">
<col style="width: 20%">
<col style="width: 18%">
<col style="width: 23%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="header">
<th></th>
<th>Global Urban-Rural Mapping Project (GRUMP)</th>
<th>Global Human Settlement Layer (GHSL)</th>
<th>LandScan</th>
<th>WorldPop</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Spatial Resolution</strong></td>
<td>30 arc-seconds (~1 km)</td>
<td>3 arc-seconds (~100m)</td>
<td>30 arc-seconds (~1km)</td>
<td>3 arc-seconds (~100m)</td>
</tr>
<tr class="even">
<td><strong>Temporal Availability</strong></td>
<td>1990, 1995, 2000</td>
<td>1975-2020 (5-year intervals)</td>
<td>2000-2022 (annual)</td>
<td>2000-2020 (annual)</td>
</tr>
<tr class="odd">
<td><strong>Organization</strong></td>
<td>CIESIN, Columbia University</td>
<td>European Commission</td>
<td>Oak Ridge National Laboratory</td>
<td>University of Southampton</td>
</tr>
<tr class="even">
<td><strong>Ancillary Data</strong></td>
<td><ul>
<li>DMSP-OLS night-time light imagery</li>
<li>Tactical pilotage charts</li>
</ul></td>
<td><ul>
<li>Sentinel-2 composite and Landsat imagery</li>
<li>Topography (DEM &amp; SRTM)</li>
<li>Road surfaces (OpenStreetMap)</li>
</ul></td>
<td><ul>
<li>DMSP-OLS night-time light imagery</li>
<li>Advanced Very High Resolution Radiometry (AVHRR) satellite imagery</li>
<li>Building characteristics (DEM)</li>
<li>Slope (NIMA Digital Terrain Elevation)</li>
<li>Global Land Cover Characteristics Database</li>
<li>Populated places vector (NIMA VMAP)</li>
</ul></td>
<td><ul>
<li>Sentinel-1 &amp; Sentinel-2 combination: ESA CCI land cover 300m annual global land cover time-series</li>
<li>Impervious surface (SRTM)</li>
<li>Slope (DEM)</li>
</ul></td>
</tr>
<tr class="odd">
<td><strong>Methods</strong></td>
<td>Area-weighted reallocation</td>
<td>Dasymetric modeling with Symbolic Machine Learning (SML) is used to combine built-up areas (GHS-BUILT) and population size (GHS-POP) to create a settlement model (GHS-SMOD) based on Degree of Urbanization (DoU), which includes seven classes along an urban-rural continuum.</td>
<td>Dasymetric modeling with machine learning (ML). Likelihood of population occurrence in a particular cell is modeled based on probability coefficients, including roads (weighted by distance from cells to roads), slope (weighted by favorable slope categories), land cover (weighted by type and applying exclusions), and night-time lights (weighted by frequency).</td>
<td>Dasymetric modeling with machine learning (ML). A random forest prediction model is used to create a weight layer.</td>
</tr>
<tr class="even">
<td><strong>Advantages</strong></td>
<td>The first of its kind, GRUMP was the ideal population distribution dataset used by researchers prior to 2010.</td>
<td>High resolution. Very accurate in areas with higher development. Not a dichotomous urban/rural variable, it allows re searchers to identify peri-urban areas.</td>
<td>Depicts ambient (24-hour average) population distribution, which captures not only where people sleep but where they travel, work, and socialize. Data available annually.</td>
<td>High resolution. Population density raster data allows researchers to define urban, peri-urban, and rural areas based on density percentages that are appropriate for that area.</td>
</tr>
<tr class="odd">
<td><strong>Limitations</strong></td>
<td>Data only available at 5-year intervals and not updated for recent years. Since it is based on proportional reallocation, it relies on accurate subnational population projections and a reliable nigh-time lights dataset.</td>
<td>Low degrees of accuracy in rural areas. Data only available at 5-year intervals.</td>
<td>Not comparable with other datasets due to its ambient nature. Regular updates to distribution algorithms makes it inadvisable to compare different versions of the dataset.</td>
<td>Population estimates are fractional (not integer), but people cannot exist over an entire area. Potential overestimates of population density in peri-urban areas and underestimates in urban centers.</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
</section>
</section>
<section id="comparing-sources" class="level1">
<h1>Comparing sources</h1>
<p>Representation of global population distribution is an increasingly important topic for researchers interested in human-environment interactions. It is vital that studies consider the advantages and limitations of the dataset they choose, as it has implications for statistical model outputs which can influence the conclusions drawn from their results. Researchers may benefit from downloading multiple datasets and comparing population density estimates based on each dataset for their study area. An example comparison is shown in <a href="#fig-2" class="quarto-xref">Figure&nbsp;2</a>, a population density map of Nairobi, Kenya, depicting the spatial extent of the Nairobi urban center based on the GHS settlement model (GHS-SMOD) in an overlay with WorldPop population density. As the map shows, the spatial extent of the urban area is not in complete agreement between the two datasets.</p>
<div id="fig-2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/image2.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: Map comparing the delineation of urban population density in Nairobi, Kenya using GHSL and WorldPop
</figcaption>
</figure>
</div>
<p>In future posts, we’ll demonstrate methods to work with some of these datasets in R!</p>

</section>

<div id="quarto-appendix" class="default"><section id="getting-help" class="level2 appendix"><h2 class="anchored quarto-appendix-heading">Getting Help</h2><div class="quarto-appendix-contents">

<p>Questions or comments? Check out the <a href="https://forum.ipums.org">IPUMS User Forum</a> or reach out to IPUMS User Support at ipums@umn.edu.</p>



</div></section><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" data-line-spacing="2" role="list">
<div id="ref-Tobler1995" class="csl-entry" role="listitem">
1. Tobler, W., Deichmann, U., Gottsegen, J., &amp; Maloy, K. (1995). <em>The global demography project</em> (Technical Report 95-6). National Center for Geographic Information <span>and</span> Analysis. <a href="https://escholarship.org/uc/item/0kt69058">https://escholarship.org/uc/item/0kt69058</a>
</div>
<div id="ref-Deichmann1996" class="csl-entry" role="listitem">
2. Deichmann, U. (1996). <em>A review of spatial population database design and modeling</em> (Technical Report 96-3). National Center for Geographic Information <span>and</span> Analysis.
</div>
<div id="ref-CIESIN" class="csl-entry" role="listitem">
3. Center for International Earth Science Information Network - CIESIN - Columbia University. (2018). <em>Gridded population of the world, version 4.11 (GPWv4): Population count</em>. Revision 11. Palisades, NY: NASA Socioeconomic Data; Applications Center (SEDAC). <a href="https://doi.org/10.7927/H4JW8BX5">https://doi.org/10.7927/H4JW8BX5</a>
</div>
<div id="ref-Balk2006" class="csl-entry" role="listitem">
4. Balk, D. L., Deichmann, U., Yetman, G., Pozzi, F., Hay, S. I., &amp; Nelson, A. (2006). Determining global population distribution: Methods, applications and data. <em>Advances in Parasitology</em>, <em>62</em>, 119–156. <a href="https://doi.org/10.1016/S0065-308X(05)62004-0">https://doi.org/10.1016/S0065-308X(05)62004-0</a>
</div>
<div id="ref-Pesaresi2013" class="csl-entry" role="listitem">
5. Pesaresi, M., Huadong, G., Blaes, X., Ehrlich, D., Ferri, S., Gueguen, L., Halkia, M., Kauffmann, M., Kemper, T., Lu, L., Marin-Herrera, M. A., Ouzounis, G. K., Scavazzon, M., Soille, P., Syrris, V., &amp; Zanchetta, L. (2013). A global human settlement layer from optical HR/VHR RS data: Concept and first results. <em>IEEE Journal of Selected Topics in Applied Earth Observations and Remote Sensing</em>, <em>6</em>(5), 2102–2131. <a href="https://doi.org/10.1109/JSTARS.2013.2271445">https://doi.org/10.1109/JSTARS.2013.2271445</a>
</div>
<div id="ref-Leyk2019" class="csl-entry" role="listitem">
6. Leyk, S., Gaughan, A. E., Adamo, S. B., Sherbinin, A. D., Balk, D., Freire, S., Rose, A., Stevens, F. R., Blankespoor, B., Frye, C., Comenetz, J., Sorichetta, A., Macmanus, K., Pistolesi, L., Levy, M., Tatem, A. J., &amp; Pesaresi, M. (2019). The spatial allocation of population: A review of large-scale gridded population data products and their fitness for use. <em>Earth System Science Data</em>, <em>11</em>(3), 1385–1409. <a href="https://doi.org/10.5194/ESSD-11-1385-2019">https://doi.org/10.5194/ESSD-11-1385-2019</a>
</div>
<div id="ref-Leyk2018" class="csl-entry" role="listitem">
7. Leyk, S., Uhl, J. H., Balk, D., &amp; Jones, B. (2018). Assessing the accuracy of multi-temporal built-up land layers across rural-urban trajectories in the <span>U</span>nited <span>S</span>tates. <em>Remote Sensing of Environment</em>, <em>204</em>, 898–917. <a href="https://doi.org/10.1016/J.RSE.2017.08.035">https://doi.org/10.1016/J.RSE.2017.08.035</a>
</div>
<div id="ref-GRUMP" class="csl-entry" role="listitem">
8. Center for International Earth Science Information Network - CIESIN - Columbia University, International Food Policy Research Institute - IFPRI, The World Bank and Centro Internacional de Agricultura Tropical - CIAT. (2011). <em>Global rural–urban mapping project, version 1 (GRUMPv1): Urban extents grid</em>. Palisades, NY: NASA Socioeconomic Data; Applications Center (SEDAC). <a href="https://doi.org/10.7927/H4GH9FVG">https://doi.org/10.7927/H4GH9FVG</a>
</div>
<div id="ref-Macmanus2021" class="csl-entry" role="listitem">
9. Macmanus, K., Balk, D., Engin, H., Mcgranahan, G., &amp; Inman, R. (2021). Estimating population and urban areas at risk of coastal hazards, 1990-2015: How data choices matter. <em>Earth System Science Data</em>, <em>13</em>(12), 5747–5801. <a href="https://doi.org/10.5194/ESSD-13-5747-2021">https://doi.org/10.5194/ESSD-13-5747-2021</a>
</div>
<div id="ref-Pesaresi2016" class="csl-entry" role="listitem">
10. Pesaresi, M., Corbane, C., Julea, A., Florczyk, A. J., Syrris, V., &amp; Soille, P. (2016). Assessment of the added-value of <span>S</span>entinel-2 for detecting built-up areas. <em>Remote Sensing</em>, <em>8</em>(4), 299. <a href="https://doi.org/10.3390/RS8040299">https://doi.org/10.3390/RS8040299</a>
</div>
<div id="ref-Florczyk2019" class="csl-entry" role="listitem">
11. Florczyk, A. J., Corbane, C., Ehrlich, D., Freire, S., Kemper, T., Maffenini, L., Melchiorri, M., Pesaresi, M., Politis, P., Schiavina, M., Sabo, F., &amp; Zanchetta, L. (2019). <em>GHSL data package 2019</em>. Publications Office of the European Union, Luxembourg, 2019. <a href="https://doi.org/10.2760/290498">https://doi.org/10.2760/290498</a>
</div>
<div id="ref-Pinchoff2020" class="csl-entry" role="listitem">
12. Pinchoff, J., Mills, C. W., &amp; Balk, D. (2020). Urbanization and health: The effects of the built environment on chronic disease risk factors among women in <span>T</span>anzania. <em>PLOS ONE</em>, <em>15</em>(11), e0241810. <a href="https://doi.org/10.1371/journal.pone.0241810">https://doi.org/10.1371/journal.pone.0241810</a>
</div>
<div id="ref-McGranahan2023" class="csl-entry" role="listitem">
13. McGranahan, G., Balk, D., Colenbrander, S., Engin, H., &amp; MacManus, K. (2023). Is rapid urbanization of low-elevation deltas undermining adaptation to climate change? A global review. <em>Environment and Urbanization</em>, <em>35</em>(2), 527–559. <a href="https://doi.org/10.1177/09562478231192176">https://doi.org/10.1177/09562478231192176</a>
</div>
<div id="ref-Florio2023" class="csl-entry" role="listitem">
14. Florio, P., Freire, S., &amp; Melchiorri, M. (2023). Estimating geographic access to healthcare facilities in <span>S</span>ub-<span>S</span>aharan <span>A</span>frica by degree of urbanisation. <em>Applied Geography</em>, <em>160</em>, 103118. <a href="https://doi.org/10.1016/J.APGEOG.2023.103118">https://doi.org/10.1016/J.APGEOG.2023.103118</a>
</div>
<div id="ref-Dobson2000" class="csl-entry" role="listitem">
15. Dobson, J. E. (2000). LandScan: A global population database for estimating populations at risk. <em>Photogrammetric Engineering &amp; Remote Sensing</em>, <em>66</em>(7), 849–857. <a href="https://www.researchgate.net/publication/267450852">https://www.researchgate.net/publication/267450852</a>
</div>
<div id="ref-Rose2014" class="csl-entry" role="listitem">
16. Rose, A. N., &amp; Bright, E. (2014). The LandScan global population distribution project: Current state of the art and prospective innovation. <em>Oak Ridge National Laboratory</em>.
</div>
<div id="ref-Thomson2022" class="csl-entry" role="listitem">
17. Thomson, D. R., Leasure, D. R., Bird, T., Tzavidis, N., &amp; Tatem, A. J. (2022). How accurate are WorldPop-<span>G</span>lobal-<span>U</span>nconstrained gridded population data at the cell-level?: A simulation analysis in urban <span>N</span>amibia. <em>PLOS ONE</em>, <em>17</em>(7), e0271504. <a href="https://doi.org/10.1371/journal.pone.0271504">https://doi.org/10.1371/journal.pone.0271504</a>
</div>
</div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/ipums\.github\.io\/dhs-research-hub");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
<p>Developed by <a href="https://www.ipums.org">IPUMS</a> at the University of Minnesota<br>Licensed under the <a href="https://www.mozilla.org/en-US/MPL/2.0/">Mozilla Public License Version 2.0</a></p>
</div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>