<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="Finn Roberts">
<meta name="author" content="Matt Gunther">
<meta name="dcterms.date" content="2024-02-04">
<meta name="description" content="Instructions for contributing to the DHS Research Hub blog">
<title>Blog Post Workflow – IPUMS DHS Climate Change and Health Research Hub</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./images/favicon/favicon-32x32.ico" rel="icon">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/quarto-contrib/fontawesome6-0.1.0/all.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/fontawesome6-0.1.0/latex-fontsize.css" rel="stylesheet"><script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-0WLH5S9VD5"></script><script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-0WLH5S9VD5', { 'anonymize_ip': true});
</script>
<meta property="og:title" content="IPUMS DHS Climate Change and Health Research Hub">
<meta property="og:description" content="Understand population health in its environmental context">
<meta property="og:image" content="https://ipums.github.io/dhs-research-hub/images/dhs_logo_navy_pad.png">
<meta property="og:site_name" content="IPUMS DHS Climate Change and Health Research Hub">
<meta property="og:image:height" content="600">
<meta property="og:image:width" content="1154">
<meta name="twitter:title" content="IPUMS DHS Climate Change and Health Research Hub">
<meta name="twitter:description" content="Understand population health in its environmental context">
<meta name="twitter:image" content="https://ipums.github.io/dhs-research-hub/images/dhs_logo_navy_pad.png">
<meta name="twitter:image-height" content="600">
<meta name="twitter:image-width" content="1154">
<meta name="twitter:card" content="summary_large_image">
</head>
<body class="floating nav-fixed slimcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner"><nav class="navbar navbar-expand-lg " data-bs-theme="dark"><div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="https://www.idhsdata.org/idhs/" class="navbar-brand navbar-brand-logo">
    <img src="./images/dhs_logo_white.png" alt="" class="navbar-logo"></a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
<li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text">Climate Change and Health Research Hub</span></a>
  </li>  
</ul>
<ul class="navbar-nav navbar-nav-scroll ms-auto">
<li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text">Posts</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-getting-started" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Getting Started</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-getting-started">
<li>
    <a class="dropdown-item" href="./posts/2024-02-01-getting-started-with-r/index.html">
 <span class="dropdown-text">An Introduction to R</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./posts/2024-02-02-download-dhs-data/index.html">
 <span class="dropdown-text">Obtaining IPUMS DHS Data</span></a>
  </li>  
    </ul>
</li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-community" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Community</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-community">
<li>
    <a class="dropdown-item" href="https://forum.ipums.org">
 <span class="dropdown-text">IPUMS Forum</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./CODE_OF_CONDUCT.html">
 <span class="dropdown-text">Code of Conduct</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./LICENSE.html">
 <span class="dropdown-text">License</span></a>
  </li>  
    </ul>
</li>
  <li class="nav-item">
    <a class="nav-link" href="./about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://github.com/ipums/dhs-research-hub"> 
<span class="menu-text"><i class="fa-brands fa-github" aria-label="github"></i></span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./index.xml"> 
<span class="menu-text"><i class="fa-solid fa-rss" aria-label="rss"></i></span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://twitter.com/ipumsGH"> 
<span class="menu-text"><i class="fa-brands fa-x-twitter" aria-label="x-twitter"></i></span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://forum.ipums.org"> 
<span class="menu-text"><i class="fa-solid fa-users" aria-label="users"></i></span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://www.ipums.org/"> 
<span class="menu-text"><i class="fa-solid fa-globe" aria-label="globe"></i></span></a>
  </li>  
</ul>
</div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav></header><!-- content --><header id="title-block-header" class="quarto-title-block default toc-left page-columns page-full"><div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Blog Post Workflow</h1>
                  <div>
        <div class="description">
          <p>Instructions for contributing to the DHS Research Hub blog</p>
        </div>
      </div>
                </div>
  </div>
    
  <div class="quarto-title-meta-author">
    <div class="quarto-title-meta-heading">Authors</div>
    <div class="quarto-title-meta-heading">Affiliations</div>
    
      <div class="quarto-title-meta-contents">
      <p class="author">Finn Roberts </p>
    </div>
    <div class="quarto-title-meta-contents">
          <p class="affiliation">
              Senior Data Analyst, IPUMS
            </p>
        </div>
      <div class="quarto-title-meta-contents">
      <p class="author">Matt Gunther </p>
    </div>
    <div class="quarto-title-meta-contents">
          <p class="affiliation">
              Research Methodologist, NORC
            </p>
        </div>
    </div>

  <div class="quarto-title-meta">

        
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">February 4, 2024</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="1"><h2 id="toc-title">Contents</h2>
   
  <ul>
<li>
<a href="#all-users-first-time-setup" id="toc-all-users-first-time-setup" class="nav-link active" data-scroll-target="#all-users-first-time-setup">All users: First time setup</a>
  <ul class="collapse">
<li>
<a href="#set-up-r-and-rstudio" id="toc-set-up-r-and-rstudio" class="nav-link" data-scroll-target="#set-up-r-and-rstudio">Set up R and RStudio</a>
  <ul class="collapse">
<li><a href="#install-r" id="toc-install-r" class="nav-link" data-scroll-target="#install-r">Install R</a></li>
  <li><a href="#install-rstudio" id="toc-install-rstudio" class="nav-link" data-scroll-target="#install-rstudio">Install RStudio</a></li>
  <li><a href="#install-r-packages" id="toc-install-r-packages" class="nav-link" data-scroll-target="#install-r-packages">Install required R packages</a></li>
  </ul>
</li>
  <li>
<a href="#configure-git-and-access-blog-materials" id="toc-configure-git-and-access-blog-materials" class="nav-link" data-scroll-target="#configure-git-and-access-blog-materials">Configure Git and access blog materials</a>
  <ul class="collapse">
<li><a href="#initialize-your-umn-github-account" id="toc-initialize-your-umn-github-account" class="nav-link" data-scroll-target="#initialize-your-umn-github-account">Initialize your UMN GitHub account</a></li>
  <li><a href="#install-git" id="toc-install-git" class="nav-link" data-scroll-target="#install-git">Install Git</a></li>
  <li><a href="#link-rstudio-and-git" id="toc-link-rstudio-and-git" class="nav-link" data-scroll-target="#link-rstudio-and-git">Link RStudio and Git</a></li>
  <li><a href="#configure-git" id="toc-configure-git" class="nav-link" data-scroll-target="#configure-git">Configure Git with your UMN GitHub credentials</a></li>
  <li><a href="#clone-the-dhs-research-hub-repository" id="toc-clone-the-dhs-research-hub-repository" class="nav-link" data-scroll-target="#clone-the-dhs-research-hub-repository">Clone the DHS Research Hub Repository</a></li>
  </ul>
</li>
  </ul>
</li>
  <li>
<a href="#authors-create-a-new-post" id="toc-authors-create-a-new-post" class="nav-link" data-scroll-target="#authors-create-a-new-post">Authors: Create a new post</a>
  <ul class="collapse">
<li><a href="#working-in-quarto" id="toc-working-in-quarto" class="nav-link" data-scroll-target="#working-in-quarto">Working in Quarto</a></li>
  <li><a href="#create-a-new-branch" id="toc-create-a-new-branch" class="nav-link" data-scroll-target="#create-a-new-branch">Create a new branch</a></li>
  <li><a href="#create-a-new-post-directory" id="toc-create-a-new-post-directory" class="nav-link" data-scroll-target="#create-a-new-post-directory">Create a new post directory</a></li>
  <li><a href="#post-metadata" id="toc-post-metadata" class="nav-link" data-scroll-target="#post-metadata">Post metadata</a></li>
  <li><a href="#put-your-data-in-data" id="toc-put-your-data-in-data" class="nav-link" data-scroll-target="#put-your-data-in-data">Put your data in <code>data</code>!</a></li>
  <li><a href="#push-your-post-to-github" id="toc-push-your-post-to-github" class="nav-link" data-scroll-target="#push-your-post-to-github">Push your post to GitHub</a></li>
  </ul>
</li>
  <li>
<a href="#editors-review-a-new-post" id="toc-editors-review-a-new-post" class="nav-link" data-scroll-target="#editors-review-a-new-post">Editors: Review a new post</a>
  <ul class="collapse">
<li><a href="#pull-the-authors-branch-to-your-computer" id="toc-pull-the-authors-branch-to-your-computer" class="nav-link" data-scroll-target="#pull-the-authors-branch-to-your-computer">Pull the author’s branch to your computer</a></li>
  <li><a href="#locate-and-edit-the-new-post" id="toc-locate-and-edit-the-new-post" class="nav-link" data-scroll-target="#locate-and-edit-the-new-post">Locate and edit the new post</a></li>
  <li><a href="#push-the-edited-post-back-to-github" id="toc-push-the-edited-post-back-to-github" class="nav-link" data-scroll-target="#push-the-edited-post-back-to-github">Push the edited post back to GitHub</a></li>
  </ul>
</li>
  <li>
<a href="#site-admin-publish-a-new-post" id="toc-site-admin-publish-a-new-post" class="nav-link" data-scroll-target="#site-admin-publish-a-new-post">Site Admin: Publish a new post</a>
  <ul class="collapse">
<li><a href="#rename-umn-github-remote" id="toc-rename-umn-github-remote" class="nav-link" data-scroll-target="#rename-umn-github-remote">Rename UMN GitHub remote</a></li>
  <li><a href="#create-a-git-hook-to-remove-data-from-the-public-repo" id="toc-create-a-git-hook-to-remove-data-from-the-public-repo" class="nav-link" data-scroll-target="#create-a-git-hook-to-remove-data-from-the-public-repo">Create a Git Hook to remove data from the public repo</a></li>
  <li><a href="#merge-a-new-post" id="toc-merge-a-new-post" class="nav-link" data-scroll-target="#merge-a-new-post">Merge a new post</a></li>
  </ul>
</li>
  </ul></nav>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
    </div>
<!-- main -->
<main class="content quarto-banner-title-block page-columns page-full" id="quarto-document-content"><section id="all-users-first-time-setup" class="level1 page-columns page-full"><h1>All users: First time setup</h1>
<p>To work on the blog, you’ll need the following:</p>
<ul>
<li>R</li>
<li>RStudio</li>
<li>Git</li>
<li>A few particular R packages</li>
</ul>
<p>If you’re working on your own machine, follow the instructions below to get this software installed.</p>
<p>The MPC also hosts a <a href="https://rstudio.pop.umn.edu/">server instance</a> of R and RStudio, which you can access using your UMN login credentials. If you prefer to work on the server, then R, RStudio, and Git will already be installed. However, you will still need to install the indicated R packages and configure your Git setup (if you haven’t done so before), so we still suggest reading through these instructions.</p>
<section id="set-up-r-and-rstudio" class="level2"><h2 class="anchored" data-anchor-id="set-up-r-and-rstudio">Set up R and RStudio</h2>
<section id="install-r" class="level3"><h3 class="anchored" data-anchor-id="install-r">Install R</h3>
<p>To install R, visit the <a href="https://cloud.r-project.org/">Comprehensive R Archive Network</a> (CRAN) and choose the appropriate download link for your operating system.</p>
</section><section id="install-rstudio" class="level3"><h3 class="anchored" data-anchor-id="install-rstudio">Install RStudio</h3>
<p>RStudio is an interactive development environment (IDE) for R that provides an interface and code editing tools that make it much, much easier to write and edit R code.</p>
<p>The DHS Research Hub is organized as an <a href="https://support.rstudio.com/hc/en-us/articles/200526207-Using-Projects">RStudio Project</a>, which requires RStudio. You can download RStudio <a href="https://rstudio.com/products/rstudio/download/">here</a>.</p>
</section><section id="install-r-packages" class="level3"><h3 class="anchored" data-anchor-id="install-r-packages">Install required R packages</h3>
<p>When you’ve got RStudio set up, install these R packages by running the following in the RStudio console:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># For writing blog posts</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"rmarkdown"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"knitr"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># For help setting up Git</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"usethis"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"gert"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"gitcreds"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>If you have trouble installing any of these packages, try to install them in a fresh RStudio session (in the RStudio toolbar, select <em>Session &gt; Restart R</em>).</p>
</div>
</div>
</section></section><section id="configure-git-and-access-blog-materials" class="level2 page-columns page-full"><h2 class="anchored" data-anchor-id="configure-git-and-access-blog-materials">Configure Git and access blog materials</h2>
<section id="initialize-your-umn-github-account" class="level3"><h3 class="anchored" data-anchor-id="initialize-your-umn-github-account">Initialize your UMN GitHub account</h3>
<p>The DHS Research Hub blog materials exist in both a <strong>public</strong> and <strong>private</strong> format. When you’re working on the blog, you’ll be working on the private site, which is hosted on the UMN Enterprise GitHub server at <a href="https://github.umn.edu/mpc/dhs-research-hub" class="uri">https://github.umn.edu/mpc/dhs-research-hub</a>.</p>
<p>The UMN GitHub server is accessible only to people affiliated with UMN. By working in this environment, we can develop and edit new posts without having to worry about them becoming visible on the public site prematurely. Also, it allows us to store files necessary for certain posts (e.g.&nbsp;IPUMS data files) without making those files publicly visible. Members of the blog “admin” team will be responsible for migrating completed posts to the public version of the site.</p>
<p>Since you’re affiliated with UMN, you automatically have access to an account on UMN GitHub. To initialize an account, visit <a href="https://github.umn.edu" class="uri">https://github.umn.edu</a> and log in with your University Internet ID and password.</p>
</section><section id="install-git" class="level3"><h3 class="anchored" data-anchor-id="install-git">Install Git</h3>
<p>To interact with GitHub, you’ll need to install Git on your local machine. Git is the version control software that allows us to track the blog’s history and manage line-by-line changes to files as we edit new posts.</p>
<section id="macos" class="level4"><h4 class="anchored" data-anchor-id="macos">MacOS</h4>
<p>MacOS comes with Git already installed. To confirm, you can check its location by running <code>which git</code> in the Mac Terminal. You can also check the version you have installed by running <code>git --version</code>.</p>
<p>If for some reason Git is not installed, use the <a href="https://jennybc.github.io/2014-05-12-ubc/ubc-r/session03_git.html#">Install Git using Homebrew</a> instructions to install it.</p>
</section><section id="other-os" class="level4"><h4 class="anchored" data-anchor-id="other-os">Other OS</h4>
<p>Users of other operating systems should <a href="http://git-scm.com/downloads">download</a> the appropriate git for their operating system.</p>
</section></section><section id="link-rstudio-and-git" class="level3"><h3 class="anchored" data-anchor-id="link-rstudio-and-git">Link RStudio and Git</h3>
<p>Next, we’ll link RStudio and Git. This adds a new tab to your RStudio interface where you can see your files being tracked by Git in a convenient point-and-click format.</p>
<p>In the RStudio toolbar, select <em>Tools &gt; Global Options</em> and locate the <em>Git/SVN</em> tab. Ensure that the box shown below is checked, and then enter the location of the executable file. To find the git executable</p>
<ul>
<li>
<strong>on MacOS</strong>: run <code>which git</code> in Terminal</li>
<li>
<strong>on Windows</strong>: look for <code>git.exe</code> in your file explorer (most likely in <em>Program Files</em>)</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="images/bpw/git-menu.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="590"></p>
</figure>
</div>
</div>
</div>
</section><section id="configure-git" class="level3"><h3 class="anchored" data-anchor-id="configure-git">Configure Git with your UMN GitHub credentials</h3>
<p>Finally, we’ll provide Git with the username and email associated with our UMN GitHub account. We’ll also need to generate a Personal Access Token (PAT) for our account. The PAT functions like a password that allows you to interact with your UMN GitHub account from R and the command line.</p>
<p>If you’ve installed the packages listed <a href="#install-r-packages">above</a>, you can use R code (rather than the command line) to configure your credentials. This is what we demonstrate below.</p>
<p>First, set the username and email address associated with your UMN GitHub account. For example, I’d run:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">gert</span><span class="fu">::</span><span class="fu"><a href="https://docs.ropensci.org/gert/reference/git_config.html">git_config_global_set</a></span><span class="op">(</span><span class="st">"user.name"</span>, <span class="st">"Finn Roberts"</span><span class="op">)</span></span>
<span><span class="fu">gert</span><span class="fu">::</span><span class="fu"><a href="https://docs.ropensci.org/gert/reference/git_config.html">git_config_global_set</a></span><span class="op">(</span><span class="st">"user.email"</span>, <span class="st">"robe2037@umn.edu"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>You don’t necessarily need to store your credentials to use Git, but if you don’t, you’ll have to enter them in a popup window each time you interact with GitHub from R or the command line.</p>
</div>
</div>
<p>Next, create a PAT for your account. Run the following in your RStudio console to launch a webpage where you can configure a new PAT:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">usethis</span><span class="fu">::</span><span class="fu"><a href="https://usethis.r-lib.org/reference/github-token.html">create_github_token</a></span><span class="op">(</span>host <span class="op">=</span> <span class="st">"https://github.umn.edu"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>You can leave the default boxes checked and click the green <em>Generate Token</em> button. This should display a long string of digits—this is your new PAT. <strong>Don’t close this page yet!</strong> Return to your RStudio console and run:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">gitcreds</span><span class="fu">::</span><span class="fu"><a href="https://gitcreds.r-lib.org/reference/gitcreds_get.html">gitcreds_set</a></span><span class="op">(</span><span class="st">"https://github.umn.edu"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This will prompt you to enter a new token. Follow the instructions to copy and paste the PAT you just generated in your browser and press <em>Enter</em>. From now on, RStudio and Git will be able to access your UMN GitHub account automatically.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>If you have a personal GitHub account at <a href="https://www.github.com">https://github.com</a> you could repeat this process substituting <code>"https://github.com"</code> for <code>"https://github.umn.edu"</code>, and Git will automatically choose the right credentials based on the repository associated with your project.</p>
</div>
</div>
</section><section id="clone-the-dhs-research-hub-repository" class="level3 page-columns page-full"><h3 class="anchored" data-anchor-id="clone-the-dhs-research-hub-repository">Clone the DHS Research Hub Repository</h3>
<p>Now that we have Git configured, we can download (or <em>clone</em>) a copy of the blog materials from UMN GitHub.</p>
<p>Open RStudio and navigate to <em>File &gt; New Project</em>, then select <em>Version Control</em>:</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="images/bpw/version_control.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="527"></p>
</figure>
</div>
</div>
</div>
<p>Choose <em>Git</em> to clone the project from a GitHub repository:</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="images/bpw/use_git.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="529"></p>
</figure>
</div>
</div>
</div>
<p>On the next menu page, enter the address for the UMN GitHub repository: <code>https://github.umn.edu/mpc/dhs-research-hub/</code></p>
<p>Hit <em>Tab</em> and the project directory name should populate automatically. If not, enter <code>dhs-research-hub</code> as the directory name:</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="images/bpw/clone_info.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="587"></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>Make sure to clone the <strong>private</strong> version of the repository (the one located at github.umn.edu), not the <strong>public</strong> version (located at github.com).</p>
</div>
</div>
<p>In the third field, choose the location where you would like to store the blog materials on your computer. This can be anywhere that makes sense with your personal file organization approach.</p>

<div class="no-row-height column-margin column-container"><div class="">
<p>When choosing a place to save this project, <em>do not save to a network drive</em>. This seems to cause RStudio to crash!</p>
</div></div><p>Finally, click <em>Create Project</em>. After a short bit, RStudio will relaunch and open the new project. If you adjust the windows to show the <strong>Files</strong> (left) and <strong>Git</strong> (right) tabs, you should see something like this:</p>
<div class="column-page">
<p><img src="images/bpw/clone_success.png" class="img-fluid"></p>
</div>
<p>You have now downloaded a copy of the DHS Research Hub blog to your computer!</p>
<p>Moreover, because you’ve connected these files to a GitHub repository, the RStudio Project will now keep track of changes you make to the files in this folder, and it will prompt you to upload your changes back to GitHub: as you add, edit, or delete files, a list of changes will appear in the Git tab.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>To ensure that RStudio recognizes the project is being used with Git, make sure to open the <code>.Rproj</code> file before working on any of the blog materials.</p>
<p>To open the project, simply click on the <code>dhs-research-hub.Rproj</code> file or navigate to <em>File &gt; Open Project</em>. (You only need to do this once at the start of your R session.)</p>
</div>
</div>
</section></section></section><section id="authors-create-a-new-post" class="level1 page-columns page-full"><h1>Authors: Create a new post</h1>
<section id="working-in-quarto" class="level3"><h3 class="anchored" data-anchor-id="working-in-quarto">Working in Quarto</h3>
<p>The DHS Research Hub is built using <a href="https://quarto.org/">Quarto</a>. Quarto is an integrated system for generating technical documents, presentations, and websites. Currently, Quarto supports several programming languages, including R.</p>
<p>Quarto builds upon the popular RMarkdown framework for writing documents with R. If you’re already familiar with RMarkdown, most of what you’ve already learned can be transferred to Quarto. For an overview of Quarto’s markdown syntax, check out this <a href="https://quarto.org/docs/authoring/markdown-basics.html">documentation</a>.</p>
</section><section id="create-a-new-branch" class="level3"><h3 class="anchored" data-anchor-id="create-a-new-branch">Create a new branch</h3>
<p>Git allows users to create what are called <em>branches</em> when working on a project. A branch functions as an independent parallel version of all of the blog materials. Any changes you make on a branch won’t automatically appear on the “main” branch of the repository. That means that you can safely modify files in a separate environment without jeopardizing work that has already been prepared for the blog.</p>
<p>To create a new branch, click on the purple icon in the Git tab of RStudio (notice that it currently says “main”, indicating we’re currently on the main branch of the repository):</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="images/bpw/new_branch.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="698"></p>
</figure>
</div>
</div>
</div>
<p>You can name the new branch anything you like, but we recommend using your URL slug if possible (e.g.&nbsp;“blog-post-workflow” is the end of the URL for this webpage). Leave the box next to <em>Sync branch with remote</em> checked, as this will create your branch both locally and on our GitHub page:</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="images/bpw/branch_name.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="317"></p>
</figure>
</div>
</div>
</div>
<p>RStudio now displays the new branch name in place of “main” to show that we’re working on the new branch:</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="images/bpw/new_branch2.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="764"></p>
</figure>
</div>
</div>
</div>
<p>Any changes you make here won’t be reflected on the main branch, meaning that the core content of the site is safe if you make a mistake on your own branch.</p>
</section><section id="create-a-new-post-directory" class="level3 page-columns page-full"><h3 class="anchored" data-anchor-id="create-a-new-post-directory">Create a new post directory</h3>
<p>The <code>posts</code> directory contains the files for each of the blog’s posts.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="images/bpw/file_window1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="978"></p>
</figure>
</div>
</div>
</div>
<p>Each post has its own sub-directory inside the <code>posts</code> directory:</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="images/bpw/posts_list.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="978"></p>
</figure>
</div>
</div>
</div>
<p>To create a new post, create a sub-directory inside <code>posts</code> with the date and a shorthand name for the post. Within that directory, create a new Quarto document (<em>File &gt; New File &gt; Quarto Document</em>) named <code>index.qmd</code>. This should open up a blank file in your RStudio session as shown below. Notice in the Git pane that Git has recognized that a new directory has been added.</p>
<div class="column-page">
<p><img src="images/bpw/post_added.png" class="img-fluid"></p>
</div>
<p>At this point, you can proceed to write your post in Quarto/RMarkdown format, as mentioned <a href="#working-in-quarto">above</a>. As you’re working on a post, you can get a preview of what the post will look like on the site by clicking the <em>Render</em> button in the toolbar above the .qmd document you’re editing.</p>

<div class="no-row-height column-margin column-container"><div class="">
<p>You can switch between previewing the page in the RStudio Viewer tab or in your computer’s default web browser. Click the settings icon next to the <em>Render</em> button for preview options.</p>
</div></div></section><section id="post-metadata" class="level3"><h3 class="anchored" data-anchor-id="post-metadata">Post metadata</h3>
<p>You’ll notice that the .qmd file contains a <strong>YAML header</strong> with various specifications about your post. The main options that you’re likely to use are:</p>
<ul>
<li>
<code>title</code>: the title of the post</li>
<li>
<code>description</code>: brief subtitle of the post</li>
<li>
<code>author</code>: the author(s) of the post (and their affiliations)</li>
<li>
<code>date</code>: the publication date of the post (this will be modified by the site admin when publishing)</li>
<li>
<code>categories</code>: tags that will be displayed and used to put posts into groups</li>
<li>
<code>bibliography</code>: a .bib file that contains the citation information for any citations used in the post. This is used to automatically format the reference list that appears at the bottom of each post. Most citation managers have an option to export a .bib file.</li>
<li>
<code>open-graph</code> and <code>twitter-card</code>: Specifications for the text and images to display when linking to this post (for instance, on Facebook, Twitter, etc.). In general, the title should be the same as the post title, with a <code>"IPUMS DHS Research Hub —"</code> prefix. The description can mirror the post description. The <code>image</code> field should be a file path (relative to the post location) to the image to use as a thumbnail that will accompany the link. Usually this will come from the body of the post.</li>
</ul>
<p>As an example, here’s the header for one of the posts on the blog:</p>
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>posts/2024-02-04-dhs-chirps/index.qmd</strong></pre>
</div>
<div class="sourceCode" id="cb5" data-filename="posts/2024-02-04-dhs-chirps/index.qmd"><pre class="sourceCode yaml code-with-copy"><code class="sourceCode yaml"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="pp">---</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span><span class="kw">:</span><span class="at"> </span><span class="st">"Attaching CHIRPS Precipitation Data to DHS Surveys"</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="fu">description</span><span class="kw">: </span><span class="ch">|</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  Remotely sensed precipitation data can provide important context for</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  understanding the health outcomes reported in the DHS</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="fu">author</span><span class="kw">:</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> Finn Roberts</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">affiliation</span><span class="kw">:</span><span class="at"> Senior Data Analyst, IPUMS</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> Matt Gunther</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">affiliation</span><span class="kw">:</span><span class="at"> Research Methodologist, NORC</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="fu">date</span><span class="kw">:</span><span class="at"> 02-04-2024</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="fu">categories</span><span class="kw">:</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> CHIRPS</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> Precipitation</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> Climate </span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> Agriculture</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> terra </span></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> sf </span></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> ggspatial</span></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> R</span></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a><span class="fu">bibliography</span><span class="kw">:</span><span class="at"> references.bib</span></span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a><span class="fu">open-graph</span><span class="kw">:</span></span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">title</span><span class="kw">:</span><span class="at"> </span><span class="st">"IPUMS DHS Research Hub — Attaching CHIRPS Precipitation Data to DHS Surveys"</span></span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a><span class="fu">  description</span><span class="kw">: </span><span class="ch">|</span></span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>    Remotely sensed precipitation data can provide important context for</span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a>    understanding the health outcomes reported in the DHS</span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">image</span><span class="kw">:</span><span class="at"> index_files/figure-html/listing-img-1.png</span></span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a><span class="fu">twitter-card</span><span class="kw">:</span></span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">title</span><span class="kw">:</span><span class="at"> </span><span class="st">"IPUMS DHS Research Hub — Attaching CHIRPS Precipitation Data to DHS Surveys"</span></span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a><span class="fu">  description</span><span class="kw">: </span><span class="ch">|</span></span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a>    Remotely sensed precipitation data can provide important context for</span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a>    understanding the health outcomes reported in the DHS</span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">image</span><span class="kw">:</span><span class="at"> index_files/figure-html/listing-img-1.png</span></span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a><span class="pp">---</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>If you’re curious, you can check out the <a href="https://quarto.org/docs/reference/formats/html.html">Quarto documentation</a> for a comprehensive list of the available options.</p>
</section><section id="put-your-data-in-data" class="level3"><h3 class="anchored" data-anchor-id="put-your-data-in-data">Put your data in <code>data</code>!</h3>
<p>We have to be careful when working with IPUMS data for a post as we want to avoid publishing any data to the public version of the site. However, editors of your post will need to have access to your data when working on the post.</p>
<p>To get around this, if you’re working with IPUMS data in your post, put it in a sub-directory called <code>data</code>. The admin team has set up a workflow that will automatically remove contents of a post’s <code>data</code> directory when publishing to the public version of the site.</p>
<p>For example, we stored the DHS extract used in the <code>dhs-chirps</code> post like so:</p>
<pre><code>./posts/2024-02-04-dhs-chirps/data/dhs/idhs_00018.dat.gz
./posts/2024-02-04-dhs-chirps/data/dhs/idhs_00018.xml</code></pre>
<p>This structure will allow the data to be shared within the team in the UMN GitHub repository, but will prevent those data from being published publicly.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>If you’re working with any data that you don’t even want to publish to <em>UMN GitHub</em> (e.g.&nbsp;if the data files are too large), put those files in a sub-directory called <code>data_local</code>. These files will automatically be ignored by Git, but they will still be available on your local system.</p>
</div>
</div>
</section><section id="push-your-post-to-github" class="level3 page-columns page-full"><h3 class="anchored" data-anchor-id="push-your-post-to-github">Push your post to GitHub</h3>
<p>When you’re finished writing, you’ll need to share (or <em>push</em>) your changes to the UMN GitHub repository.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Pushing to the UMN GitHub repository is not the same thing as publishing your post to the live website. Your post won’t go live until someone from the admin team merges your post into the main branch and migrates it to the public GitHub repository.</p>
</div>
</div>
<p>Render your post one more time by clicking <em>Render</em>.</p>
<p>Now, enter the following commands into the RStudio console. This will make a Git <em>commit</em>, which is simply a snapshot of the files in the repository with an associated message describing the updates you’re making. Be sure to adjust brief commit message (in line 2) so it’s relevant to your new post:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">gert</span><span class="fu">::</span><span class="fu"><a href="https://docs.ropensci.org/gert/reference/git_commit.html">git_add</a></span><span class="op">(</span><span class="st">"."</span><span class="op">)</span></span>
<span><span class="fu">gert</span><span class="fu">::</span><span class="fu"><a href="https://docs.ropensci.org/gert/reference/git_commit.html">git_commit</a></span><span class="op">(</span><span class="st">"New draft: blog-post-workflow"</span><span class="op">)</span> <span class="co"># Change this!</span></span>
<span><span class="fu">gert</span><span class="fu">::</span><span class="fu"><a href="https://docs.ropensci.org/gert/reference/git_fetch.html">git_push</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now, if you visit the repository on UMN GitHub, your post will appear in a new branch!</p>
<div class="column-page">
<p><img src="images/bpw/see_branches.png" class="img-fluid"></p>
</div>
</section></section><section id="editors-review-a-new-post" class="level1"><h1>Editors: Review a new post</h1>
<section id="pull-the-authors-branch-to-your-computer" class="level3"><h3 class="anchored" data-anchor-id="pull-the-authors-branch-to-your-computer">Pull the author’s branch to your computer</h3>
<p>Any time that you want to review an author’s post, you’ll always need to get the latest copy of their branch from the UMN GitHub repository. If this is the first time you’ve read a draft for the post, the author’s branch won’t yet be listed in RStudio.</p>
<p>The <strong>Pull</strong> button in RStudio’s Git tab will gather information about all of the new branches on GitHub, and it will download a copy of each one onto your computer:</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="images/bpw/pull_button.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="698"></p>
</figure>
</div>
</div>
</div>
<p>Returning to RStudio’s main window, notice that you can now toggle between the working on the remote <code>main</code> branch, or the new remote branch (in this example, <code>blog-post-workflow</code>). When you’re ready to edit the author’s post, use this menu to click their branch under <em>Local Branches</em>.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="images/bpw/toggle_branches.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="548"></p>
</figure>
</div>
</div>
</div>
<p>RStudio will automatically create a local version of this branch on your computer, and it should report that your changes will be tracked and pushed to the remote branch of the same name.</p>
</section><section id="locate-and-edit-the-new-post" class="level3"><h3 class="anchored" data-anchor-id="locate-and-edit-the-new-post">Locate and edit the new post</h3>
<p>At this point, the Git tab should show that you’re working on the author’s branch, and you’ll see their post listed in the <code>posts</code> folder in the Files tab. Navigate to the <code>index.qmd</code> file for their post and open it to begin making edits.</p>
<p>You can edit using RMarkdown just as you would as an author. Remember that you can preview the post by clicking the <em>Render</em> button at the top of the file.</p>
</section><section id="push-the-edited-post-back-to-github" class="level3"><h3 class="anchored" data-anchor-id="push-the-edited-post-back-to-github">Push the edited post back to GitHub</h3>
<p>When you’re finished editing, click the <em>Render</em> button one more time to render a final HTML version of the page. (This may also generate other ancillary files used on the site, which you’ll see in the Git tab.)</p>
<p>Now, make a commit recording your edits (again, adjust the commit message as appropriate).</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">gert</span><span class="fu">::</span><span class="fu"><a href="https://docs.ropensci.org/gert/reference/git_commit.html">git_add</a></span><span class="op">(</span><span class="st">"."</span><span class="op">)</span></span>
<span><span class="fu">gert</span><span class="fu">::</span><span class="fu"><a href="https://docs.ropensci.org/gert/reference/git_commit.html">git_commit</a></span><span class="op">(</span><span class="st">"Draft edited: blog-post-workflow"</span><span class="op">)</span> <span class="co"># Change this!</span></span>
<span><span class="fu">gert</span><span class="fu">::</span><span class="fu"><a href="https://docs.ropensci.org/gert/reference/git_fetch.html">git_push</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now, if you visit our UMN GitHub repository, you’ll see that your edited files appear on the author’s branch.</p>
</section></section><section id="site-admin-publish-a-new-post" class="level1"><h1>Site Admin: Publish a new post</h1>
<p>The following instructions demonstrate how to add an additional remote to your local dhs-research-hub repository. <strong>You only need to follow these instructions if you are involved in managing updates to the live blog.</strong> All of these commands can be run in the RStudio Terminal.</p>
<section id="rename-umn-github-remote" class="level3"><h3 class="anchored" data-anchor-id="rename-umn-github-remote">Rename UMN GitHub remote</h3>
<p>Before adding a second remote, it’s best to rename the UMN GitHub remote to disambiguate it from the public repository remote that you will be adding. You can check the current name with:</p>
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Terminal</strong></pre>
</div>
<div class="sourceCode" id="cb9" data-filename="Terminal"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> remote</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>By default, the remote will be called <code>origin</code>. We suggest renaming it to <code>private</code>:</p>
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Terminal</strong></pre>
</div>
<div class="sourceCode" id="cb10" data-filename="Terminal"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> remote rename origin private</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Similarly, you should also give the <code>private/main</code> branch a new name, as the public repository will also contain a <code>main</code> branch.</p>
<p>To see all of the remote branches currently in use:</p>
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Terminal</strong></pre>
</div>
<div class="sourceCode" id="cb11" data-filename="Terminal"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> remote show private</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Checkout <code>main</code> and change its name. We suggest <code>private-main</code>:</p>
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Terminal</strong></pre>
</div>
<div class="sourceCode" id="cb12" data-filename="Terminal"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> checkout main</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> branch <span class="at">-m</span> <span class="st">"private-main"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now, add the <strong>public remote</strong> and fetch its branches (there should only be one, called <code>main</code>):</p>
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Terminal</strong></pre>
</div>
<div class="sourceCode" id="cb13" data-filename="Terminal"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> remote add public https://github.com/ipums/dhs-research-hub</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> fetch public</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Create a local branch called <code>public-main</code> set to track with <code>main</code> on the <code>public</code> remote:</p>
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Terminal</strong></pre>
</div>
<div class="sourceCode" id="cb14" data-filename="Terminal"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> branch public-main public/main</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>At this point, you’ll notice that RStudio shows two remotes (with the branches you’ve fetched) and all of the local branches you’ve created so far.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="images/bpw/dual-remotes.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="435"></p>
</figure>
</div>
</div>
</div>
</section><section id="create-a-git-hook-to-remove-data-from-the-public-repo" class="level3"><h3 class="anchored" data-anchor-id="create-a-git-hook-to-remove-data-from-the-public-repo">Create a Git Hook to remove data from the public repo</h3>
<p><strong>We should never push IPUMS data extracts to the public repository</strong>, but we need to have these data available on the private repository in order to build each others’ posts when we want to review or merge new content.</p>
<p>Recall that all data used in a post should be stored in the <code>data</code> directory. Fortunately, we don’t have to manually delete every <code>data</code> directory before merging to the public remote. Instead, we can use <a href="https://git-scm.com/docs/githooks">git hooks</a> to automate the process of deleting these files every time a post is merged to the public remote.</p>
<p>To do so, create a file called <code>post-merge</code> containing the following code, and put it in the <code>.git/hooks/</code> directory:</p>
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>.git/hooks/post-merge</strong></pre>
</div>
<div class="sourceCode" id="cb15" data-filename=".git/hooks/post-merge"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co">#! /bin/sh</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="va">green</span><span class="op">=</span><span class="st">'\033[0;32m'</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="va">nc</span><span class="op">=</span><span class="st">'\033[0m'</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Start from the repository root.</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="bu">cd</span> ./<span class="va">$(</span><span class="fu">git</span> rev-parse <span class="at">--show-cdup</span><span class="va">)</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Delete data files and empty directories.</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="bu">[</span> <span class="kw">`</span><span class="fu">git</span> rev-parse <span class="at">--abbrev-ref</span> HEAD<span class="kw">`</span> <span class="ot">==</span> <span class="st">"public-main"</span> <span class="bu">]</span><span class="kw">;</span> <span class="cf">then</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>  <span class="bu">echo</span> <span class="st">"</span><span class="va">${green}</span><span class="st">Deleting data files...</span><span class="va">${nc}</span><span class="st">"</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">find</span> . <span class="at">-path</span> <span class="st">'*/data/*'</span> <span class="at">-delete</span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">find</span> . <span class="at">-type</span> d <span class="at">-empty</span> <span class="at">-delete</span></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a><span class="cf">fi</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>This will only delete <code>data</code> folders if a branch called <code>public-main</code> is currently checked out when we run <code>git merge</code> (see below). <strong>If you gave a different name to your local public branch, you’ll have to edit this code.</strong></p>
</div>
</div>
<p>You also must make this file executable. For MacOS users, you can do this by entering the following command into Terminal (assuming you’re already in the <code>dhs-research-hub</code> directory):</p>
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Terminal</strong></pre>
</div>
<div class="sourceCode" id="cb16" data-filename="Terminal"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">chmod</span> +x .git/hooks/post-merge</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now, when you follow the merging steps below, any file saved in a directory called <code>data</code> (including all sub-directories) will be deleted automatically.</p>
</section><section id="merge-a-new-post" class="level3"><h3 class="anchored" data-anchor-id="merge-a-new-post">Merge a new post</h3>
<p>To merge a new post, we first need to merge the content from the author’s branch to the main branch of the private repository. Then, we need to merge the main branch of the private repository to the main branch of the public repository.</p>
<p>We follow a “squash and merge” workflow to help avoid creating divergent commit histories between the private and public repositories:</p>
<ol type="1">
<li>Squash and Merge the author’s branch to <code>private/main</code>
</li>
<li>Build site, Commit, and Push to <code>private/main</code>
</li>
<li>Merge <code>private/main</code> to <code>public/main</code>
</li>
<li>Push to <code>public/main</code>
</li>
</ol>
<p>Our authoring/editing workflow generates a commit each time someone adds a change to the branch for a new post. We will <a href="https://docs.gitlab.com/ee/user/project/merge_requests/squash_and_merge.html">squash and merge</a> this commit history into a single commit on <code>private/main</code>.</p>
<p>For example, with a new post on the branch <code>blog-post-workflow</code>:</p>
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Terminal</strong></pre>
</div>
<div class="sourceCode" id="cb17" data-filename="Terminal"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> checkout private-main</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> merge <span class="at">--squash</span> blog-post-workflow</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now that the post is merged, we can render the full site by running:</p>
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Terminal</strong></pre>
</div>
<div class="sourceCode" id="cb18" data-filename="Terminal"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="ex">quarto</span> render</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Look over the site to make sure everything looks good. It’s also worth double-checking the <code>git diff</code> to make sure that there aren’t any unexpected file changes that resulted from adding the new post. We won’t be making edits directly to the public repository, so this is the time to make any final changes.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>Reviewing Git changes is more easily done in a Git client interface. Unfortunately, not all Git clients are freely available for GitHub Enterprise repositories, but <a href="https://desktop.github.com/">GitHub Desktop</a> is one option that we find helpful.</p>
</div>
</div>
<p>When you’re ready, add all files and commit your changes with a relevant message:</p>
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Terminal</strong></pre>
</div>
<div class="sourceCode" id="cb19" data-filename="Terminal"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> add .</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> commit <span class="at">-m</span> <span class="st">"new post: blog-post-workflow"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Although your local branch has a different name than the branch on the remote, you can still push your commit to the remote <code>main</code> with the following command:</p>
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Terminal</strong></pre>
</div>
<div class="sourceCode" id="cb20" data-filename="Terminal"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> push private HEAD:main</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<!-- You'll now see that the GitHub Pages site hosted at UMN GitHub should -->
<!-- update to reflect your changes. -->
<p>To merge your <code>private-main</code> to <code>public-main</code>:</p>
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Terminal</strong></pre>
</div>
<div class="sourceCode" id="cb21" data-filename="Terminal"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> checkout public-main</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> merge <span class="at">--squash</span> <span class="at">--allow-unrelated-histories</span> private-main <span class="at">-X</span> theirs</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p><code>--squash</code> once again squashes all changes in the private repository into a single commit. This means that all changes since the last merge to the public repository will be reflected in this commit. You may want to update your commit message to reflect this fact (e.g.&nbsp;if you are merging multiple posts at once).</p>
<p><code>--allow-unrelated-histories</code> allows the merge even though the public and private repositories do not share a baseline history. This isn’t a concern here—we don’t want the public version of the site to reflect all our small changes when working on posts.</p>
<p><code>-X theirs</code> indicates that we want to defer to the changes on <code>private-main</code> over those on <code>public-main</code> in the event that there are any conflicts.</p>
</div>
</div>
<p>At this point, review the files that will be included in the merge commit. You should not see any <code>data</code> folders, as they should be deleted automatically (if not, <strong>delete them now</strong>).</p>
<p>When you’re ready to commit the merge, run the following (with a relevant commit message):</p>
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Terminal</strong></pre>
</div>
<div class="sourceCode" id="cb22" data-filename="Terminal"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> add .</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> commit <span class="at">-m</span> <span class="st">"new post: blog-post-workflow"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Finally, push the new post to the <code>main</code> branch of the public repository:</p>
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Terminal</strong></pre>
</div>
<div class="sourceCode" id="cb23" data-filename="Terminal"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> push public HEAD:main</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The new post has now gone live!</p>


</section></section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/ipums\.github\.io\/dhs-research-hub");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
<p>Developed by <a href="https://www.ipums.org">IPUMS</a> at the University of Minnesota<br>Licensed under the <a href="https://www.mozilla.org/en-US/MPL/2.0/">Mozilla Public License Version 2.0</a></p>
</div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>


</body></html>