{
  "hash": "b3ae052971357c450a0f2f86303d8353",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Obtaining Data from IPUMS DHS\"\ndescription: |\n  Identify and download data from the IPUMS DHS website and load it into R\nauthor:\n  - name: Finn Roberts\n    affiliation: Senior Data Analyst, IPUMS\n  - name: Matt Gunther\n    affiliation: Research Methodologist, NORC\ndate: 02-02-2024\ncategories:\n  - Tips\n  - Importing data\n  - R\nfig-width: 10\nfig-height: 8\nimage: ../../images/dhs_logo_navy.png\nopen-graph:\n  title: \"Obtaining Data from IPUMS DHS\"\n  description: |\n    Identify and download data from the IPUMS DHS website and load it into R\n  image: ../../images/dhs_logo_navy_pad.png\ntwitter-card:\n  title: \"Obtaining Data from IPUMS DHS\"\n  description: |\n    Identify and download data from the IPUMS DHS website and load it into R\n  image: ../../images/dhs_logo_navy_pad.png\n---\n\n::: {.cell}\n\n:::\n\n\n\n[The Demographic and Health Surveys Program](https://dhsprogram.com/)\n(DHS) is the leading source of population health data for low- and\nmiddle-income countries around the world. [IPUMS\nDHS](https://www.idhsdata.org/idhs/) disseminates a harmonized version\nof the DHS survey results in which variables are integrated across time\nand space, facilitating comparative and longitudinal analysis.\nFurthermore, IPUMS DHS provides a web interface and streamlined\ndocumentation to make the data discovery and download process easier.\n\n# Accessing the data\n\nTo obtain access to IPUMS DHS data, you must first [request data\naccess](https://dhsprogram.com/data/new-user-registration.cfm) from the\nDHS Program. Once you've done so, you can use your username and password\nfrom DHS to log in to IPUMS DHS.\n\n## Browse data\n\nUsers can browse the available data using the IPUMS DHS [data selection\ninterface](https://www.idhsdata.org/idhs-action/variables/group), which\nincludes sample and variable availability, descriptions, codes, and\nmore.\n\nFor more information about how to use the interface, see the IPUMS DHS\n[user guide](https://www.idhsdata.org/idhs/user_guide.shtml).\n\n## Select data\n\nOnce you've selected the samples and variables you want to include in\nyour data extract, click **View Cart** to review your selections. If\nyou're satisfied with the contents of your extract, click **Create Data\nExtract**.\n\n\n\n::: {.cell .column-body-outset layout-align=\"center\"}\n::: {.cell-output-display}\n![](images/dhs-download1.png){fig-align='center' width=100%}\n:::\n:::\n\n\n\nIPUMS DHS allows you to select one of several output file formats. On\nthis blog, we will use the default *fixed-width* (.dat) file option,\nwhich is the format expected by the data-reading functions provided in\nipumsr.\n\n\n\n::: {.cell .column-body-outset layout-align=\"center\"}\n::: {.cell-output-display}\n![](images/dhs-download2.png){fig-align='center' width=100%}\n:::\n:::\n\n\n\nClick **Submit Extract** to submit your extract for processing on the\nIPUMS servers. You'll receive an email when your extract is complete and\nready to download.\n\n## Download data\n\nClick the green download button to download the compressed data file for\nyour extract.\n\nYou will also need to download an associated metadata (DDI) file. This\nis an XML file that contains parsing instructions for the fixed-width\ndata file as well as descriptive information about the variables\ncontained in an extract.\n\n::: column-margin\nDDI stands for [Data Documentation\nInitiative](https://ddialliance.org/), an international standard for\ndocumenting data obtained in survey research.\n:::\n\nYou can do so by right clicking the **DDI** link and selecting **Save\nlink as...**.\n\n\n\n::: {.cell .column-page layout-align=\"center\"}\n::: {.cell-output-display}\n![](images/microdata_annotated_screenshot.png){fig-align='center' width=100%}\n:::\n:::\n\n\n\n::: callout-tip\nThe specific text included in the dropdown may differ based on the\nbrowser that you are using. For instance, Safari displays the option\n**Download Linked File As...**.\n\nThe important thing is that you download the DDI file in **.xml**\nformat, *not* .html format.\n:::\n\n# Load IPUMS DHS data into R\n\nThe `{ipumsr}` package provides the tools you'll need to easily load\nyour extract into R.\n\n::: column-margin\n`<div class=\"hex\">\n<a href=\"https://tech.popdata.org/ipumsr/\" class=\"hex\">\n<img src=\"../../images/hex/ipumsr.png\" class=\"hex-img\"/>\n</a>\n<p class=\"hex-cap\">© IPUMS (MPL-2.0)</p>\n</div>`{=html}\n:::\n\nIf you haven't previously installed the package, you can do so with:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ninstall.packages(\"ipumsr\")\n```\n:::\n\n\n\nTo load your data, use `read_ipums_micro()`. If your data file and DDI\nfile are in the same directory, you can load the data by providing only\nthe DDI file path. To be safe, we typically provide the path to both\nfiles.\n\nNote that you'll need to adjust the file paths to reflect the location\nof the files on your local system.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ipumsr)\n\ndhs <- read_ipums_micro(\n  ddi = \"data/dhs/idhs_00015.xml\",\n  data_file = \"data/dhs/idhs_00015.dat.gz\",\n)\n#> Use of data from IPUMS DHS is subject to conditions including that users should cite the data appropriately. Use command `ipums_conditions()` for more details.\n```\n:::\n\n\n\nYou should now have a tabular data source loaded into R:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndhs\n#> # A tibble: 25,689 × 59\n#>    SAMPLE        SAMPLESTR  COUNTRY    YEAR IDHSPID IDHSHID DHSID IDHSPSU CASEID\n#>    <int+lbl>     <chr+lbl>  <int+lbl> <int> <chr>   <chr>   <chr>   <dbl> <chr> \n#>  1 85403 [Burki… 854… [Bur… 854 [Bur…  2003 85403 … 85403 … BF20… 8.54e10 1 76 …\n#>  2 85403 [Burki… 854… [Bur… 854 [Bur…  2003 85403 … 85403 … BF20… 8.54e10 1 76 …\n#>  3 85403 [Burki… 854… [Bur… 854 [Bur…  2003 85403 … 85403 … BF20… 8.54e10 1 76 …\n#>  4 85403 [Burki… 854… [Bur… 854 [Bur…  2003 85403 … 85403 … BF20… 8.54e10 1 98 …\n#>  5 85403 [Burki… 854… [Bur… 854 [Bur…  2003 85403 … 85403 … BF20… 8.54e10 1 98 …\n#>  6 85403 [Burki… 854… [Bur… 854 [Bur…  2003 85403 … 85403 … BF20… 8.54e10 1113 …\n#>  7 85403 [Burki… 854… [Bur… 854 [Bur…  2003 85403 … 85403 … BF20… 8.54e10 1207 …\n#>  8 85403 [Burki… 854… [Bur… 854 [Bur…  2003 85403 … 85403 … BF20… 8.54e10 1207 …\n#>  9 85403 [Burki… 854… [Bur… 854 [Bur…  2003 85403 … 85403 … BF20… 8.54e10 1232 …\n#> 10 85403 [Burki… 854… [Bur… 854 [Bur…  2003 85403 … 85403 … BF20… 8.54e10 1232 …\n#> # ℹ 25,679 more rows\n#> # ℹ 50 more variables: HHID <chr>, PSU <dbl>, DOMAIN <dbl>, HHNUM <dbl>,\n#> #   CLUSTERNO <dbl>, LINENO <int>, BIDX <int>, PERWEIGHT <dbl>, KIDWT <dbl>,\n#> #   AWFACTT <dbl>, AWFACTU <dbl>, AWFACTR <dbl>, AWFACTE <dbl>, AWFACTW <dbl>,\n#> #   DVWEIGHT <dbl>, INTYEAR <int>, MONTHINT <int+lbl>, INTDAY <int>,\n#> #   INTDATECMC <dbl>, URBAN <int+lbl>, RESIDEINTYR <int+lbl>,\n#> #   GEO_BF2003_2010 <int+lbl>, GEO_BF2003 <int+lbl>, GEO_BF2010 <int+lbl>, …\n```\n:::\n\n\n\n### Why use ipumsr?\n\nSeveral R packages already exist for reading external data files. There\nare a few reasons we suggest using ipumsr to work with IPUMS data.\n\n#### Load compressed files\n\nFirst, IPUMS delivers data extracts as compressed archives. ipumsr\nanticipates this and allows you to load data directly without having to\nmanually decompress these files.\n\n#### View variable metadata\n\nFurthermore, ipumsr uses the metadata contained in an extract's DDI file\nto attach contextual information to the loaded data. For instance, to\nget a description of a variable contained in an extract, use\n`ipums_var_label()`:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nipums_var_label(dhs$HWHAZWHO)\n#> [1] \"Height for age standard deviations from median (WHO)\"\n```\n:::\n\n\n\nUse `ipums_val_labels()` to check if there are any labeled values in the\ndata for that variable. Labeled values typically represent categories\n(for non-continuous variables) or contain information about the codes\nused for missing values.\n\nFor `HWHAZWHO`, several values represent different types of missing\ndata. (You will likely want to convert these values to `NA` before\nconducting an analysis using this variable!)\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nipums_val_labels(dhs$HWHAZWHO)\n#> # A tibble: 5 × 2\n#>     val lbl                                \n#>   <int> <chr>                              \n#> 1  9995 Height out of plausible limits     \n#> 2  9996 Age in days out of plausible limits\n#> 3  9997 Flagged cases                      \n#> 4  9998 Missing                            \n#> 5  9999 NIU (not in universe)\n```\n:::\n\n\n\nMore details about working with IPUMS metadata can be found in the\n[ipumsr\ndocumentation](https://tech.popdata.org/ipumsr/articles/value-labels.html).\n\n#### Access the IPUMS API\n\nFinally, ipumsr provides an R interface for the IPUMS API, allowing you\nto request and download data entirely within your R environment. While\nthese features do not currently support IPUMS DHS, work on the API is\nongoing, so you may be able to access IPUMS DHS data in the future! To\nsee more about the projects that are currently supported by the IPUMS\nAPI, check out the [API\ndocumentation](https://developer.ipums.org/docs/v2/apiprogram/).\n\nSee the [API\nintroduction](https://tech.popdata.org/ipumsr/articles/ipums-api.html)\nto learn how to use ipumsr to interact with the IPUMS API.\n\n## Getting Help {.appendix}\n\nQuestions or comments? Check out the [IPUMS User\nForum](https://forum.ipums.org) or reach out to IPUMS User Support at\nipums\\@umn.edu.\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}